<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>JS Bridge</title>
    <style>
      body {
        background-color: #7e7e7e;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
        font-family: Arial, sans-serif;
      }

      .button-container {
        text-align: center;
        margin-bottom: 20px;
      }

      input[type="button"] {
        margin: 5px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div>Version: 0.1.0</div>
    <br />
    <div id="info"></div>
    <br />
    <div class="button-container">
      <input
        type="button"
        value="Get Dating Token"
        onClick="getDatingToken()"
      />
      <br />
      <input
        type="button"
        value="Send Verification Success"
        onClick="sendVerificationSuccess()"
      />
      <br />
      <input
        type="button"
        value="Send Verification Error"
        onClick="sendVerificationError()"
      />
      <br />
      <input type="button" value="Send Analytics" onClick="sendAnalytics()" />
    </div>

    <div
      id="jwtDisplay"
      style="
        margin-top: 20px;
        padding: 10px;
        background-color: #f0f0f0;
        border-radius: 5px;
        display: none;
        max-width: 600px;
        width: 90%;
      "
    >
      <p
        id="jwtTokenText"
        style="word-break: break-all; font-family: monospace; font-size: 12px"
      ></p>
    </div>

    <script type="text/javascript">
      const test = Date.now();
      console.log(test);

      const queryString = window.location.search;
      const urlParams = new URLSearchParams(queryString);
      const lang = urlParams.get("lang");
      const sidParam = urlParams.get("sid");

      let sid = null;

      switch (sidParam) {
        case "0":
          sid = "Android";
          break;

        case "1":
          sid = "iOS";
          break;
      }

      const infoDiv = document.getElementById("info");
      infoDiv.textContent = "Lang: " + lang + ", sid: " + sid;

      window.AppHandlers = {
        onRequestSuccess: function (requestId, data) {
          const payload = data ? " Data: " + JSON.stringify(data) : "";

          jwtTokenText.textContent = "Request ID: " + requestId + payload;
          jwtDisplay.style.display = "block";
        },

        onRequestError: function (requestId, error) {
          console.log("Request ID: " + requestId + " Error: " + error);
        },
      };

      function getDatingToken() {
        const requiestId = +Date.now();
        App.request(requiestId, "Dating.getDatingToken", "{}");
      }

      function sendVerificationSuccess() {
        const requiestId = Date.now().toString();
        App.request(requiestId, "Dating.sendVerificationSuccess", "{}");
      }

      function sendVerificationError() {
        const requiestId = Date.now();
        App.request(
          requiestId,
          "Dating.sendVerificationError",
          '{ "code": 500,  "messages": ["Something went wrong"]}'
        );
      }

      function sendAnalytics() {
        const requiestId = Date.now().toString();
        App.request(
          requiestId,
          "Analytics.track",
          '{eventName: "Act on Dating by tabs [Dating]", "properties": {}}'
        );
      }
    </script>

    <footer></footer>
  </body>
</html>
